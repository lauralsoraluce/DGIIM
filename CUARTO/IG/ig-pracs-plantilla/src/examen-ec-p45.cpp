// Nombre: Laura, Apellidos: Lázaro Soraluce, Titulación: GIM.
// email: lazarosoraluce@correo.ugr.es, DNI o pasaporte: 45350527R

#include "examen-ec-p45.h"

//////////////////////////////// EJERICCIO 4 ////////////////////////////////


MallaP4::MallaP4():MallaInd("MallaP4")
{
    vertices =
      {
         {+1.0, -1.0, +1.0}, // 0
         {+1.0, +1.0, +1.0}, // 1
         {+1.0, +1.0, -1.0}, // 2
         {+1.0, -1.0, -1.0}, // 3

         {-1.0, -1.0, +1.0}, // 4
         {-1.0, +1.0, +1.0}, // 5
         {+1.0, +1.0, +1.0}, // 6
         {+1.0, -1.0, +1.0}, // 7


         {-1.0, -1.0, -1.0}, // 8
         {-1.0, +1.0, -1.0}, // 9
         {-1.0, +1.0, +1.0}, // 10
         {-1.0, -1.0, +1.0}, // 11

         {+1.0, -1.0, -1.0}, // 12
         {+1.0, +1.0, -1.0}, // 13
         {-1.0, +1.0, -1.0}, // 14
         {-1.0, -1.0, -1.0}, // 15

         {+1.0, -1.0, +1.0}, // 16
         {-1.0, -1.0, +1.0}, // 17
         {-1.0, -1.0, -1.0}, // 18
         {+1.0, -1.0, -1.0}, // 19

        {+1.0, +1.0, +1.0}, // 20
        {0.0, +2.0, 0.0}, // 21
        {+1.0, +1.0, -1.0}, // 22 

        {-1.0, +1.0, +1.0}, // 23
        {0.0, +2.0, 0.0}, // 24
        {+1.0, +1.0, +1.0}, // 25

        {-1.0, +1.0, -1.0}, // 26
        {0.0, +2.0, 0.0}, // 27
        {-1.0, +1.0, +1.0}, // 28

        {+1.0, +1.0, -1.0}, // 29
        {0.0, +2.0, 0.0}, // 30
        {-1.0, +1.0, -1.0} // 31

      };

   triangulos =
      {
         {0, 3, 2},
         {0, 2, 1},

         {4, 7, 6},
         {4, 6, 5},

         {8, 11, 10},
         {8, 10, 9},

         {12, 15, 14},
         {12, 14, 13},

         {18, 19, 16},
         {17, 18, 16},

         {22, 21, 20},
         {25, 24, 23},
         {28, 27, 26},
         {31, 30, 29}
      };
      
   cc_tt_ver = {
      {0.75, 1.0-0.0},
      {0.75, 1.0-0.5},
      {1.0, 1.0-0.5},
      {1.0, 1.0-0.0},

      {0.5, 1.0-0.0},
      {0.5, 1.0-0.5},
      {0.75, 1.0-0.5},
      {0.75, 1.0-0.0},

      {0.25, 1.0-0.0},
      {0.25, 1.0-0.5},
      {0.5, 1.0-0.5},
      {0.5, 1.0-0.0},

      {0.0, 1.0-0.0},
      {0.0, 1.0-0.5},
      {0.25, 1.0-0.5},
      {0.25, 1.0-0.0},

      {0.5, 1.0-0.5},
      {0.5, 1.0-1.0},
      {0.75, 1.0-1.0},
      {0.75, 1.0-0.5},

      {0.0, 1.0-0.5},
      {0.125, 1.0-1.0},
      {0.25, 1.0-0.5},

      {0.0, 1.0-0.5},
      {0.125, 1.0-1.0},
      {0.25, 1.0-0.5},

      {0.0, 1.0-0.5},
      {0.125, 1.0-1.0},
      {0.25, 1.0-0.5},

      {0.0, 1.0-0.5},
      {0.125, 1.0-1.0},
      {0.25, 1.0-0.5}
   };

   calcularNormales();
}

NodoP4::NodoP4(){
   agregar( new Material( new Textura("ventanas-tejado-2048x1024.jpg") , 0.1, 0.8, 0.6, 15.0) );
   agregar( new MallaP4() );
}

//////////////////////////////// EJERICCIO 5 ////////////////////////////////

MiCasa::MiCasa(unsigned i){
   pos = i;
   pm_rot = leerPtrMatriz(agregar(glm::translate(glm::vec3(0.0))));
   agregar(new NodoP4());
}

bool MiCasa::cuandoClick(const glm::vec3 & centro_wc) {
    float angulo = 1.0*M_PI/6;
    *pm_rot *= rotate(angulo,glm::vec3(0.0,1.0,0.0));
   std::cout << "Has hecho click en la casa número " << pos << std::endl;

   return true;
}

NodoUrbaP5::NodoUrbaP5(int n){

    NodoGrafoEscena *fila_casas = new NodoGrafoEscena();
    for(int j=0; j<n; j++){
        MiCasa *casa = new MiCasa(j);
        casa->ponerIdentificador(j);
        fila_casas->agregar(glm::translate(glm::vec3(2.0,0.0,0.0)));
        fila_casas->agregar(casa);
    }
    agregar(fila_casas);
}